# Implementation Plan: shadcnui-signage Library

**Created:** 2026-02-07  
**Status:** ✅ Complete  
**Requirements:** [Signage Components Library Requirements](./2026-02-07-shadcnui-signage-requirements.md)

## Goal

Create a new React component library (`@tsa/shadcnui-signage`) for building digital signage screens, optimized for fixed-aspect displays, distance readability, and predictable layouts. The library will include four v0.1 components: ScreenFrame, SplitScreen, FullscreenHero, and InfoCardGrid.

## Context

### Current State

- Existing libraries: `@tsa/shadcnui` (base components) and `@tsa/shadcnui-blocks` (generic compositions)
- Nx 22.4.1 + pnpm monorepo with Vite, React 19, TypeScript 5.9.3
- Storybook 10.2.0 for component documentation
- Vitest 4.0.0 for unit testing
- Tailwind CSS v4 with CSS-first configuration

### Why This Work

Digital signage has unique requirements compared to web applications:

- Fixed aspect ratios and known resolutions
- Typography optimized for distance viewing
- Predictable layouts without responsive breakpoints
- Simple, deterministic compositions

This library extends our existing shadcn foundation for this specific use case.

### Dependencies

- Must depend on `@tsa/shadcnui` for base components
- May depend on `@tsa/shadcnui-blocks` where appropriate
- May depend on `common-tailwind` for shared Tailwind configuration
- Must not create circular dependencies with apps

## Task Breakdown

### Phase 1: Project Setup ⬜ Not Started

**Objective:** Create the library structure and configure tooling.

**Tasks:**

1. **Generate library with Nx** ⬜

   - Command: `npx nx g @nx/react:lib shadcnui-signage`
   - Options: Use default Nx React library generator
   - Verify: `libs/shadcnui-signage/` directory exists

2. **Configure TypeScript path mapping** ⬜

   - File: `tsconfig.base.json`
   - Add: `"@tsa/shadcnui-signage": ["libs/shadcnui-signage/src/index.ts"]`
   - Verify: Import resolves in consuming app

3. **Create folder structure** ⬜

   - Create: `src/lib/primitives/`, `src/lib/layouts/`, `src/lib/blocks/`, `src/lib/types/`, `src/lib/utils/`
   - Verify: Folders exist with correct structure

4. **Add dependencies to project.json** ⬜

   - Add `@tsa/shadcnui`, `@tsa/shadcnui-blocks`, `common-tailwind` as dependencies
   - Verify: Dependencies resolve correctly

5. **Create initial README.md** ⬜
   - File: `libs/shadcnui-signage/README.md`
   - Include: Purpose, relationship to other libs, components list, concepts
   - Verify: Documentation is clear and accurate

**Acceptance Criteria:**

- ✅ Library builds: `pnpm build:shadcnui-signage`
- ✅ TypeScript imports work: `import { } from '@tsa/shadcnui-signage'`
- ✅ Nx graph shows correct dependencies
- ✅ README.md exists with basic documentation

**Files to Change:**

- `tsconfig.base.json` (add path mapping)
- `libs/shadcnui-signage/` (new directory)
- `libs/shadcnui-signage/README.md` (new file)
- `libs/shadcnui-signage/project.json` (generated by Nx)

---

### Phase 2: Utility Functions ⬜ Not Started

**Objective:** Implement resolution helpers and clamping utilities.

**Tasks:**

1. **Create resolution utility** ⬜

   - File: `src/lib/utils/resolution.ts`
   - Exports: `getResolution`, `getAspectRatio`
   - Types: `Resolution = "1080p" | "4k" | "portrait-1080p"`
   - Logic: Return { width, height } for each resolution

2. **Test resolution utility** ⬜

   - File: `src/lib/utils/resolution.spec.ts`
   - Coverage: All resolution types, aspect ratio calculations
   - Verify: 100% coverage for this utility

3. **Create clamp utility** ⬜

   - File: `src/lib/utils/clamp.ts`
   - Export: `getClampClass` for text truncation
   - Logic: Return Tailwind classes for line clamping (line-clamp-1, line-clamp-2, etc.)

4. **Test clamp utility** ⬜

   - File: `src/lib/utils/clamp.spec.ts`
   - Coverage: All clamp values
   - Verify: 100% coverage for this utility

5. **Create types file** ⬜
   - File: `src/lib/types/signage.types.ts`
   - Export: Common types for components (Resolution, Ratio, Density, etc.)
   - Verify: Types are reusable across components

**Acceptance Criteria:**

- ✅ All utility functions have 100% test coverage
- ✅ Tests pass: `pnpm test:shadcnui-signage`
- ✅ Types are exported from main entry point
- ✅ No duplication of types or logic

**Files to Change:**

- `src/lib/utils/resolution.ts` (new)
- `src/lib/utils/resolution.spec.ts` (new)
- `src/lib/utils/clamp.ts` (new)
- `src/lib/utils/clamp.spec.ts` (new)
- `src/lib/types/signage.types.ts` (new)
- `src/index.ts` (export types and utilities)

---

### Phase 3: ScreenFrame Component ⬜ Not Started

**Objective:** Build the ScreenFrame primitive for resolution preview.

**Tasks:**

1. **Implement ScreenFrame component** ⬜

   - File: `src/lib/primitives/ScreenFrame.tsx`
   - Props: `resolution`, `scale`, `showSafeArea`, `children`, `className`
   - Logic: Use resolution utility, CSS transform for scaling, optional safe area overlay
   - Style: Use Tailwind v4 classes, no hardcoded sizes

2. **Test ScreenFrame component** ⬜

   - File: `src/lib/primitives/ScreenFrame.spec.tsx`
   - Coverage: Resolution switching, scaling, safe area toggle
   - Verify: ≥80% coverage

3. **Create ScreenFrame stories** ⬜

   - File: `src/lib/primitives/ScreenFrame.stories.tsx`
   - Stories: 1080p, 4k, portrait-1080p, with/without safe area
   - Content: Use realistic signage placeholder content
   - Verify: Stories render correctly in Storybook

4. **Add JSDoc documentation** ⬜
   - Document: Props, usage examples, when to use
   - Verify: Documentation is clear and accurate

**Acceptance Criteria:**

- ✅ Component renders all resolutions correctly
- ✅ Content remains clipped within frame
- ✅ Safe area overlay toggles correctly
- ✅ Unit tests pass with ≥80% coverage
- ✅ Storybook stories demonstrate all use cases
- ✅ Accessibility: semantic HTML, proper ARIA attributes

**Files to Change:**

- `src/lib/primitives/ScreenFrame.tsx` (new)
- `src/lib/primitives/ScreenFrame.spec.tsx` (new)
- `src/lib/primitives/ScreenFrame.stories.tsx` (new)
- `src/index.ts` (export ScreenFrame)

---

### Phase 4: SplitScreen Component ⬜ Not Started

**Objective:** Build the SplitScreen layout for two-zone compositions.

**Tasks:**

1. **Implement SplitScreen component** ⬜

   - File: `src/lib/layouts/SplitScreen.tsx`
   - Props: `direction`, `ratio`, `primary`, `secondary`, `gap`, `className`
   - Logic: CSS grid or flex with fixed ratios (50-50, 60-40, 70-30, 80-20)
   - Style: Use Tailwind v4, no overflow

2. **Test SplitScreen component** ⬜

   - File: `src/lib/layouts/SplitScreen.spec.tsx`
   - Coverage: All ratios, directions, gap sizes
   - Verify: ≥80% coverage

3. **Create SplitScreen stories** ⬜

   - File: `src/lib/layouts/SplitScreen.stories.tsx`
   - Stories: All ratios (4), directions (2), gap sizes (4)
   - Wrap in: ScreenFrame for consistent preview
   - Verify: Stories render correctly in Storybook

4. **Add JSDoc documentation** ⬜
   - Document: Props, usage examples, ratio guidance
   - Verify: Documentation is clear and accurate

**Acceptance Criteria:**

- ✅ All ratios render as expected
- ✅ No overflow for reasonable content
- ✅ Direction switch works correctly
- ✅ Gap sizes apply correctly
- ✅ Unit tests pass with ≥80% coverage
- ✅ Storybook stories demonstrate all variants
- ✅ Accessibility: semantic HTML, proper landmarks

**Files to Change:**

- `src/lib/layouts/SplitScreen.tsx` (new)
- `src/lib/layouts/SplitScreen.spec.tsx` (new)
- `src/lib/layouts/SplitScreen.stories.tsx` (new)
- `src/index.ts` (export SplitScreen)

---

### Phase 5: FullscreenHero Component ⬜ Not Started

**Objective:** Build the FullscreenHero block for announcements and welcome screens.

**Tasks:**

1. **Implement FullscreenHero component** ⬜

   - File: `src/lib/blocks/FullscreenHero.tsx`
   - Props: `title`, `subtitle`, `body`, `cta`, `variant`, `backgroundImageUrl`, `logo`, `className`
   - Logic: Text clamping (title: 2 lines, subtitle: 2 lines, body: 4 lines), background overlay for contrast
   - Style: Use Tailwind v4, shadcn tokens for colors, strong typography hierarchy

2. **Test FullscreenHero component** ⬜

   - File: `src/lib/blocks/FullscreenHero.spec.tsx`
   - Coverage: Text clamping, variants, background image overlay
   - Verify: ≥80% coverage

3. **Create FullscreenHero stories** ⬜

   - File: `src/lib/blocks/FullscreenHero.stories.tsx`
   - Stories: Normal content, long text (clamping demo), background image, light/dark variants
   - Wrap in: ScreenFrame at 1080p
   - Verify: Stories render correctly, contrast is readable

4. **Add JSDoc documentation** ⬜

   - Document: Props, usage examples, variant guidance
   - Verify: Documentation is clear and accurate

5. **Verify WCAG AA contrast** ⬜
   - Tool: Browser DevTools or contrast checker
   - Check: Light and dark variants meet 4.5:1 for normal text, 3:1 for large text
   - Verify: Background image overlay preserves contrast

**Acceptance Criteria:**

- ✅ Long text never overflows
- ✅ Light and dark variants remain readable (WCAG AA)
- ✅ Background image does not reduce legibility
- ✅ Unit tests pass with ≥80% coverage
- ✅ Storybook stories demonstrate all variants
- ✅ Accessibility: semantic HTML (header, h1, h2), proper heading hierarchy, sufficient contrast

**Files to Change:**

- `src/lib/blocks/FullscreenHero.tsx` (new)
- `src/lib/blocks/FullscreenHero.spec.tsx` (new)
- `src/lib/blocks/FullscreenHero.stories.tsx` (new)
- `src/index.ts` (export FullscreenHero)

---

### Phase 6: InfoCardGrid Component ⬜ Not Started

**Objective:** Build the InfoCardGrid block for menus, promos, and KPIs.

**Tasks:**

1. **Implement InfoCardGrid component** ⬜

   - File: `src/lib/blocks/InfoCardGrid.tsx`
   - Props: `items`, `columns`, `density`, `highlightIndex`, `className`
   - Types: `InfoCardItem = { title, value?, description?, meta? }`
   - Logic: Equal height cards, clamped text, highlight without layout shift
   - Style: Use Tailwind v4, shadcn Card component from `@tsa/shadcnui`

2. **Test InfoCardGrid component** ⬜

   - File: `src/lib/blocks/InfoCardGrid.spec.tsx`
   - Coverage: Item count, column logic, highlight behavior, density variants
   - Verify: ≥80% coverage

3. **Create InfoCardGrid stories** ⬜

   - File: `src/lib/blocks/InfoCardGrid.stories.tsx`
   - Stories: 2/3/4 columns, highlight example, density variants (comfortable, compact), various content lengths
   - Wrap in: ScreenFrame at 1080p
   - Verify: Stories render correctly, cards are aligned

4. **Add JSDoc documentation** ⬜
   - Document: Props, usage examples, when to use
   - Verify: Documentation is clear and accurate

**Acceptance Criteria:**

- ✅ Grid renders correctly at 1080p
- ✅ Highlight does not break alignment
- ✅ Compact and comfortable density behave predictably
- ✅ Unit tests pass with ≥80% coverage
- ✅ Storybook stories demonstrate all use cases
- ✅ Accessibility: semantic HTML (article/section), proper heading hierarchy

**Files to Change:**

- `src/lib/blocks/InfoCardGrid.tsx` (new)
- `src/lib/blocks/InfoCardGrid.spec.tsx` (new)
- `src/lib/blocks/InfoCardGrid.stories.tsx` (new)
- `src/index.ts` (export InfoCardGrid)

---

### Phase 7: Integration & Documentation ⬜ Not Started

**Objective:** Complete documentation, verify integration, and ensure CI passes.

**Tasks:**

1. **Update main README.md** ⬜

   - File: `libs/shadcnui-signage/README.md`
   - Add: Complete usage examples for all four components
   - Add: Installation instructions, testing instructions
   - Add: Concepts (resolution, safe area, clamping)
   - Verify: Documentation is comprehensive and accurate

2. **Verify public API exports** ⬜

   - File: `src/index.ts`
   - Exports: ScreenFrame, SplitScreen, FullscreenHero, InfoCardGrid, types, utilities
   - Verify: Named exports only, no default exports, no wildcard exports

3. **Test in consuming app** ⬜

   - App: `apps/client`
   - Import: `import { ScreenFrame } from '@tsa/shadcnui-signage'`
   - Create: Test page demonstrating all components
   - Verify: Components render correctly, no import errors

4. **Run full verification** ⬜

   - Command: `pnpm verify`
   - Checks: Format, lint, type-check, test, build (affected projects)
   - Verify: All checks pass

5. **Check test coverage** ⬜

   - Command: `pnpm test:shadcnui-signage --coverage`
   - Verify: ≥80% coverage overall
   - Verify: Each component has ≥80% coverage

6. **Verify Storybook integration** ⬜

   - Command: `pnpm storybook`
   - Check: All stories appear in Storybook UI
   - Verify: Stories render correctly, controls work

7. **Review Nx dependency graph** ⬜
   - Command: `npx nx graph`
   - Verify: `shadcnui-signage` depends on `shadcnui`, `shadcnui-blocks`, `common-tailwind`
   - Verify: No circular dependencies
   - Verify: Apps can import from `shadcnui-signage`

**Acceptance Criteria:**

- ✅ Documentation is complete and accurate
- ✅ Public API exports are correct (named exports only)
- ✅ Components work in consuming app
- ✅ `pnpm verify` passes
- ✅ Test coverage ≥80%
- ✅ Storybook stories render correctly
- ✅ Nx dependency graph is correct

**Files to Change:**

- `libs/shadcnui-signage/README.md` (update)
- `src/index.ts` (verify exports)
- `apps/client/src/` (test page, optional)

---

## Definition of Done

**All criteria from requirements must be met:**

- ✅ Library created with Nx: `npx nx g @nx/react:lib shadcnui-signage`
- ✅ TypeScript path mapping added to `tsconfig.base.json`
- ✅ `libs/shadcnui-signage` builds: `pnpm build:shadcnui-signage`
- ✅ Public API exports four v0.1 components from `src/index.ts` (named exports only)
- ✅ Storybook stories exist and render in Storybook 10.2.0
- ✅ Unit tests pass: `pnpm test:shadcnui-signage`
- ✅ Minimum 80% test coverage
- ✅ Linting passes: `pnpm lint:shadcnui-signage`
- ✅ Type checking passes: `pnpm type-check:shadcnui-signage`
- ✅ No duplication of shadcn primitives or tokens
- ✅ Components are visually credible at signage resolutions
- ✅ Accessibility requirements met (WCAG AA)
- ✅ `README.md` documentation complete
- ✅ CI passes: `pnpm verify`

## Verification Commands

```bash
# Build library
pnpm build:shadcnui-signage

# Run tests with coverage
pnpm test:shadcnui-signage --coverage

# Lint
pnpm lint:shadcnui-signage

# Type check
pnpm type-check:shadcnui-signage

# Full verification (format, lint, type-check, test, build)
pnpm verify

# Start Storybook
pnpm storybook

# Nx dependency graph
npx nx graph
```

## Progress Tracking

**Phase 1 (Project Setup):** ✅ Complete  
**Phase 2 (Utility Functions):** ✅ Complete  
**Phase 3 (ScreenFrame):** ✅ Complete  
**Phase 4 (SplitScreen):** ✅ Complete  
**Phase 5 (FullscreenHero):** ✅ Complete  
**Phase 6 (InfoCardGrid):** ✅ Complete  
**Phase 7 (Integration & Documentation):** ✅ Complete

**Overall Status:** ✅ Complete (7/7 phases complete)

## Notes

- Follow TheSignAge conventions: named exports only, colocate tests, JSDoc comments
- Use existing shadcn components from `@tsa/shadcnui` (Card, Button, etc.)
- Use Tailwind v4 CSS-first configuration from `common-tailwind`
- Test early and often: run `pnpm test:shadcnui-signage` after each component
- Verify Storybook stories as you build: `pnpm storybook`
- Commit incrementally: one logical change per commit
- Use conventional commit messages: `feat(shadcnui-signage): add ScreenFrame component`

## Risks & Mitigations

**Risk:** Dependency conflicts with existing libraries  
**Mitigation:** Verify Nx dependency graph after Phase 1, adjust imports as needed

**Risk:** Test coverage falls below 80%  
**Mitigation:** Write tests alongside implementation, check coverage after each component

**Risk:** Components don't render correctly at target resolutions  
**Mitigation:** Test in ScreenFrame at 1080p, 4k, and portrait-1080p in Storybook

**Risk:** Accessibility requirements not met  
**Mitigation:** Use semantic HTML, verify contrast with DevTools, test keyboard navigation

**Risk:** Storybook integration issues  
**Mitigation:** Test stories incrementally, follow existing Storybook patterns from `@tsa/shadcnui`
